President Trump s new executive order on immigration addresses some of the legal problems found by courts in the Jan. 27 original order, but is still vulnerable on some of the same legal grounds. As a constitutional law professor who has recently written on this topic, I d contend that Trump s lawyers are not out of the woods yet.The new executive order still has the original s 120-day ban on the entry of refugees from all countries. Jettisoned is the indefinite ban on Syrian refugees. The new order keeps the 90-day ban on entry by persons from six majority Muslim countries Iran, Syria, Somalia, Sudan, Libya and Yemen. But the new order removes Iraq from the list. The change came because of Iraq s role in assisting the U.S. in the fight against the Islamic State and its enhanced security measures, according to Secretary of State Rex Tillerson. The revised order also removes the original s preference for refugees who are members of minority religions in their country of origin. Stating this preference had opened the Trump administration up to the argument that the original order aided Christians and other non-Muslims in violation of the separation of church and state. But the change may be too little, too late. The federal court that struck down the first executive order on church-state grounds also relied on statements by Trump and Rudy Giuliani that the purpose of the order was to effectuate a Muslim ban. The new executive order doesn t undo the effect of those statements. You can t unring that bell.Additionally, the current executive order clarifies that it does not apply to green card holders or those who hold lawful visas. This detail will help Trump defend against arguments that the order violates the Constitution s due process clause, which was the basis for the federal appellate court ruling that the order was unconstitutional. The due process clause provides that the government cannot take away someone s liberty without notice and a hearing before an unbiased decision-maker. It applies even to noncitizens if they are present in the U.S., but not to noncitizens abroad. Exempting noncitizens with green cards or visas means there are far fewer people affected by the executive order who have the right to complain of a due process problem. But other legal issues apply equally to the original and revised orders. By imposing a blanket ban on anyone coming from one of the remaining six majority Muslim countries, this week s executive order still arguably runs afoul of a 1965 statute that bans discrimination on the basis of national origin regarding visas. To be sure, by exempting current visa holders from the executive order s reach, the universe of potential legal challengers on this ground shrinks. But to the extent the executive order burdens those seeking new visas, there may still be a viable legal challenge.Ultimately, the only way to know for sure the legal effect of this new executive order is to wait for a court ruling. Given that the American Civil Liberties Union has already pledged to challenge the new executive order in its ongoing litigation against the immigrant ban, we may not have to wait long.