Is President Trump s recent executive order on immigrants and refugees legal? It s a surprisingly tricky question. The order arguably violates both a federal statute and one or more sections of the Constitution depending on whether the immigrant is already in the U.S. In the end, opponents best hope for undoing the order might rest on the separation of church and state. Trump s order bars the entry of any refugee for 120 days, and Syrian refugees indefinitely. It also bans citizens of Iraq, Iran, Syria, Somalia, Sudan, Libya and Yemen from entering the U.S. for 90 days. This order potentially affects more than 20,000 refugees, along with thousands of students nationwide. Depending on how it is enforced, it could also impact as many as hundreds of thousands of green card holders, or immigrants with permanent residency.Many opponents have challenged the order in court. A U.S. District Court judge in Brooklyn, New York, issued a ruling that halted the enforcement of Trump s executive order the day after he signed it. Judges in at least four other states followed suit. Trump s supporters defend the order s legality based on a federal immigration statute passed in 1952 that allows the president to suspend the U.S. entry of any class of aliens. But, as a former U.S. Justice Department lawyer and a law professor, I believe there are at least four possible arguments challenging the legality of the order.There is, critically, another federal statute that outlaws discriminating against a person regarding issuing visas based on the person s nationality, place of birth, or place of residence, which Trump s order clearly does. This second statute was passed in 1965 and is more specific than the 1952 statute. What s more, courts have enforced this anti-discrimination ban strictly. This is the strongest legal argument against President Trump s order. But Congress can amend or repeal the 1965 statute, as it can any law. A Republican-controlled Congress might do that, although concerns raised by some GOP lawmakers may make that unlikely. The recent court orders halting enforcement of the Trump order relied on a legal argument that it violated due process or equal protection under the Constitution. Due process means that people get procedural safeguards like advance notice, a hearing before a neutral decision-maker and a chance to tell their side of the story before the government takes away their liberty. Equal protection means the government must treat people equally, and can t discriminate on the basis of race, alien status, nationality, and other irrelevant factors. As the Supreme Court has said, even immigrants who are not citizens or green card holders have due process and equal protection rights, if and only if they are physically here in the U.S. That s why the recent court orders on due process and equal protection help only individuals who were in the States at the time the court ruled. Given the rushed, chaotic manner in which the recent order was drafted and enforced, with no set chance for affected individuals to plead their case, maybe there are some valid due process arguments against the ban. But presumably, those can be fixed by slowing down and letting people have their say. Once that s done, the remaining issue is whether the executive order violates equal protection by intentionally discriminating against Muslims.Trump denies the order is a Muslim ban, even though he called for exactly that during the campaign, and each of the seven countries subject to the ban is majority Muslim. In explaining why those seven countries were chosen, the order itself cites the Obama-era law stating that persons who in recent years have visited one of these seven terrorism-prone nations would not be eligible under a visa waiver program. Similarly, says Trump, the defining characteristic here is terrorist danger, not religion. That s why only seven of more than 40 majority Muslim countries are affected. (Note that the Obama-era rule isn t based on nationality, but rather on whether someone of any nationality visited the danger zone since 2011 a criterion not outlawed by the 1965 statute.)One problem with Trump s argument is that the order also seems to prioritize admitting Christian refugees. It does this by saying that once the 120-day ban on all refugees expires, priority goes to those of a minority religion in the individual s country. Supporters can rightly argue this minority religion language is neutral. It never mentions Muslims or Christians. But, as that neutral language interacts with the country-specific ban targeting seven Muslim countries, the two can t help but disproportionately help Christians. Indeed, just days before signing the order, Trump told the Christian Broadcasting Network he intended to prioritize Christian refugees. That brings us to the final legal argument against the president s order. By picking favorites among religions, it violates the separation of church and state under the Constitution s Establishment Clause of the First Amendment. Though Establishment Clause law is often murky, one clear point is that the government can t favor one religious denomination over another. This may be the most important of the constitutional theories involved in this case because it may have the broadest scope. The due process and equal protection arguments only help persons who are already in the United States. Theoretically, a court ruling on those arguments might invalidate the order only as it applies to such persons. But if the order violates the Establishment Clause by making a statement favoring Christianity, a court could strike it down entirely.